<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âœ ë©”ëª¨ì¥</title>
    <style>
        body {
            background-color: rgba(0, 0, 0, 0.8);
            font-family: 'Gothic A1', sans-serif;
        }

        .container {
            margin: 50px auto 0 auto;
            background-color: #fff;
            width: 500px;
            padding: 5px 0px 5px 20px;
            border-radius: 10px;
        }

        /* ì¤„ë°”ê¿ˆ ì†ì„±(ê¸€ìë‹¨ìœ„) */
        li {
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ˜ ì˜¤ëŠ˜ í•  ì¼</h1>
        <input id="inputField" type="text" placeholder="ì—¬ê¸°ì— ì ì–´:)">
        <button id="addToDo">ì¶”ê°€</button>
        <button id="deleteAll">ì „ì²´ì‚­ì œ</button>
        <h2>ë¦¬ìŠ¤íŠ¸ì—…!</h2>
        <p>ë¦¬ìŠ¤íŠ¸ë¥¼ í´ë¦­í•˜ë©´ ì·¨ì†Œì„ ì´ ìƒê¸°ê³ , ë”ë¸”í´ë¦­í•˜ë©´ ì‚­ì œë©ë‹ˆë‹¤.</p>

        <!-- inputFieldì— í• ì¼ì´ ì…ë ¥ë˜ê³  + ë²„íŠ¼ì´ ëˆŒë¦¬ë©´ í• ì¼ì´ ë‚˜íƒ€ë‚˜ëŠ” ê³µê°„-->
        <div id="toDoList" class="to-dos"></div>
    </div>
    <script>
        // ìš”êµ¬ì‚¬í•­
        // 1. ë©”ëª¨ ìƒì„±
        // 2. (ë‚˜ì•„ê°€ê¸°) ë©”ëª¨ ì¼ê´„ ì‚­ì œí•˜ê¸°
        // 3. (ë‚˜ì•„ê°€ê¸°) ê°œë³„ ë©”ëª¨ ì‚­ì œí•˜ê¸°
        // 4. (ë‚˜ì•„ê°€ê¸°) ë©”ëª¨ì— ë‚ ì§œì™€ ì‹œê°„, ìš”ì¼ í•¨ê»˜ ì‚½ì…í•˜ê¸°

        const inputBox = document.getElementById('inputField'); 
        const addToDo = document.getElementById('addToDo'); 
        const toDoList = document.getElementById('toDoList');
        const deleteAll = document.getElementById('deleteAll');

        const TODOS_Ls = "toDos"; // TODOS_LsëŠ” ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— toDoList(ul) ë³€ìˆ˜ëª…ì„ ì €ì¥í•œ ìƒìˆ˜
        let toDos = [];

        addToDo.addEventListener('click', function() {
            // ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´, <li>íƒœê·¸ ë§Œë“¤ê¸°
            let list = document.createElement('li');
            const newId = toDos.length + 1; 

            // ì…ë ¥ì°½ì— ë‚´ìš©ì´ ì—†ìœ¼ë©´ alert ë„ìš°ê¸°
            if (!inputBox.value) {
                alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!ğŸ˜');
                // TODO: ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ ì•ˆë˜ê²Œ í•˜ê¸°
            } else { 
                // ë‚ ì§œ, ì‹œê°„, ìš”ì¼ ì‚½ì…
                const date = new Date();
                const arrayDay = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
                const stringDate = (date.getMonth()+1) + 'ì›”Â ' + date.getDate() + 'ì¼('+ arrayDay[date.getDay()] + ') ' + date.getHours() + 'ì‹œ ' + date.getMinutes() + 'ë¶„ì— ì‘ì„±í•¨';

                // listì˜ innerTextëŠ” inputBoxì˜ value
                list.innerText = inputBox.value + ' ' + stringDate;

                // ë¦¬ìŠ¤íŠ¸ì—…ì˜ ìì‹ìœ¼ë¡œ ë¶™ì´ê¸°
                toDoList.appendChild(list);

                // toDosì— ë¦¬ìŠ¤íŠ¸ push
                // toDos.push(list.innerText);
                text = list.innerText;
                const toDoObj = {
                    text,
                    id: newId,
                };
                toDos.push(toDoObj); // toDosì— toDoList ì‚½ì…

                // toDoList ë‚´ë¶€ì˜ ê°’ì„ ì €ì¥
                localStorage.setItem(TODOS_Ls, JSON.stringify(toDos));

                // ì…ë ¥ì°½ ë¹„ìš°ê¸°
                inputBox.value = "";
            }

            // listë¥¼ í´ë¦­í•˜ë©´ ì¤„ ê¸‹ê¸°
            list.addEventListener('click', function() {
                list.style.textDecoration = "line-through";
            })

            // listë¥¼ ë”ë¸”í´ë¦­í•˜ë©´ ë¦¬ìŠ¤íŠ¸ì—…ì—ì„œ ì§€ìš°ê¸°
            list.addEventListener('dblclick', function() {
                toDoList.removeChild(list);
            })
        })


        // // ìƒˆë¡œê³ ì¹¨ í™”ë©´ì—ì„œ ì €ì¥ëœ ë‚´ìš© ë³´ì—¬ì£¼ê¸°(ìœ ì§€í•˜ê¸°)
        // // TODO: ì·¨ì†Œì„ ì„ ìœ ì§€í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?
        // const memo = localStorage.getItem('memo')
        
        // // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ memoë¼ëŠ” keyë¥¼ ë¹ˆë°°ì—´ì— push(splitìœ¼ë¡œ ë¬¸ì -> ë°°ì—´)
        // toDos.push(...memo.split(','))
        
        // if (toDoList !== null) {
        //     for (let i = 0; i < toDos.length; i++) {
        //         let list = document.createElement('li');
        //         toDoList.appendChild(list);

        //         // listë¥¼ í´ë¦­í•˜ë©´ ì¤„ ê¸‹ê¸°(ìƒˆë¡œê³ ì¹¨ í›„ì—ë„ ì ìš©ë˜ì–´ì•¼ í•˜ëŠ” ì´ë²¤íŠ¸)
        //         list.addEventListener('click', function() {
        //             list.style.textDecoration = "line-through";
        //         })

        //         // listë¥¼ ë”ë¸”í´ë¦­í•˜ë©´ ë¦¬ìŠ¤íŠ¸ì—…ì—ì„œ ì§€ìš°ê¸°(ìƒˆë¡œê³ ì¹¨ í›„ì—ë„ ì ìš©ë˜ì–´ì•¼ í•˜ëŠ” ì´ë²¤íŠ¸)
        //         list.addEventListener('dblclick', function() {
        //             toDoList.removeChild(list);
        //         })

        //         // ì²«ë²ˆì§¸ liì—ëŠ” ì²«ë²ˆì§¸ toDosë¥¼, ...
        //         toDoList.childNodes[i].innerText = toDos[i]
        //     }
        // } 

        function handleSubmit(event) {
            event.preventDefault(); // ì´ë²¤íŠ¸ê°€ ì‘ë™í•˜ì§€ ëª»í•˜ê²Œ í•¨
            const currentValue = inputBox.value; // currentValueì— inputì°½ì— ì…ë ¥í•œ ê°’ ëŒ€ì…
            paintToDo(currentValue); // ë¦¬ìŠ¤íŠ¸ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
            inputBox.value = ""; // inputì°½ ì´ˆê¸°í™”
        }

        function loadToDos() {
            const loadedToDos = localStorage.getItem(TODOS_Ls);
            // localStorageì— TODOS_Lsê°€ ìˆëŠ”ì§€ í™•ì¸
            if (loadedToDos !== null) {
                const parsedToDos = JSON.parse(loadedToDos); // loadedToDosë¥¼ jsonê°ì²´ë¡œ ë³€ê²½
                parsedToDos.forEach(function (toDo) { // ê°ì²´ ë‚´ìš© í•œê°œì”© íŒŒë¼ë¯¸í„°ë¡œ ë„£ì–´ì„œ í•¨ìˆ˜ ì‹¤í–‰
                    
                    // paintToDo(toDo.text); // ë¦¬ìŠ¤íŠ¸ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜


                    addToDo.addEventListener('click', function() {
                    // ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´, <li>íƒœê·¸ ë§Œë“¤ê¸°
                    let list = document.createElement('li');
                    const newId = toDos.length + 1; 

                    // ì…ë ¥ì°½ì— ë‚´ìš©ì´ ì—†ìœ¼ë©´ alert ë„ìš°ê¸°
                    if (!inputBox.value) {
                        alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!ğŸ˜');
                        // TODO: ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ ì•ˆë˜ê²Œ í•˜ê¸°
                    } else { 
                        // ë‚ ì§œ, ì‹œê°„, ìš”ì¼ ì‚½ì…
                        const date = new Date();
                        const arrayDay = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
                        const stringDate = (date.getMonth()+1) + 'ì›”Â ' + date.getDate() + 'ì¼('+ arrayDay[date.getDay()] + ') ' + date.getHours() + 'ì‹œ ' + date.getMinutes() + 'ë¶„ì— ì‘ì„±í•¨';

                        // listì˜ innerTextëŠ” inputBoxì˜ value
                        list.innerText = inputBox.value + ' ' + stringDate;

                        // ë¦¬ìŠ¤íŠ¸ì—…ì˜ ìì‹ìœ¼ë¡œ ë¶™ì´ê¸°
                        toDoList.appendChild(list);

                        toDo.text = list.innerText;

                        text = toDo.text;
                        const toDoObj = {
                            text,
                            id: newId,
                        };
                        toDos.push(toDoObj); // toDosì— toDoList ì‚½ì…

                        // toDoList ë‚´ë¶€ì˜ ê°’ì„ ì €ì¥
                        localStorage.setItem(TODOS_Ls, JSON.stringify(toDos));

                        // ì…ë ¥ì°½ ë¹„ìš°ê¸°
                        inputBox.value = "";
                    }

                    // listë¥¼ í´ë¦­í•˜ë©´ ì¤„ ê¸‹ê¸°
                    list.addEventListener('click', function() {
                        list.style.textDecoration = "line-through";
                    })

                    // listë¥¼ ë”ë¸”í´ë¦­í•˜ë©´ ë¦¬ìŠ¤íŠ¸ì—…ì—ì„œ ì§€ìš°ê¸°
                    list.addEventListener('dblclick', function() {
                        toDoList.removeChild(list);
                    })
                })
                });
            }
        }



        // ì „ì²´ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸
        deleteAll.addEventListener('click', function() {
            // i) lië¥¼ querySelectorAllë¡œ ì¡ëŠ” ë°©ì‹
            const createdList = document.querySelectorAll('li');
            createdList.forEach(item => {
                item.remove();
            });

            // ii) lië¥¼ getElementsByTagNameë¡œ ì¡ëŠ” ë°©ì‹
            // const createdList = document.getElementsByTagName('li');
            // for (let i = createdList.length - 1; i >= 0; --i) {
            //     createdList[i].remove();
            // }

            // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ëœ ë‚´ìš©ì„ ëª¨ë‘ ì œê±°
            // TODO: ì „ì²´ì‚­ì œ ë²„íŠ¼ í´ë¦­ í›„ toDosë°°ì—´ì— ì•ˆ ë‚¨ì•„ ìˆê²Œ í•˜ê¸°
            localStorage.clear();
        })

    </script>
</body>
</html>
